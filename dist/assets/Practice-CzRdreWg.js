const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Scene-Xd6BfVcW.js","assets/three-TZlvwelR.js","assets/Particles-z5Lh8XKJ.js","assets/HandModel-BUwkpGQG.js","assets/mediapipe-CLPwVCrs.js"])))=>i.map(i=>d[i]);
import{r as n,j as e,_ as b}from"./three-TZlvwelR.js";import{A as L,m as R}from"./index-B5Vxm1D_.js";import"./gsap-C8pce-KX.js";const S=n.lazy(()=>b(()=>import("./Scene-Xd6BfVcW.js"),__vite__mapDeps([0,1,2,3]))),H=n.lazy(()=>b(()=>import("./HandModel-BUwkpGQG.js"),__vite__mapDeps([3,1])));let p=null,y=null;function T(){const i=n.useRef(null),s=n.useRef(null),[d,v]=n.useState(!1),[j,x]=n.useState(null),[w,h]=n.useState(0),[_,o]=n.useState(null),[m,N]=n.useState(!1),u=n.useRef(null),P=n.useRef(null);n.useEffect(()=>{(async()=>{try{N(!0);const[{Hands:c},{Camera:a}]=await Promise.all([b(()=>import("./mediapipe-CLPwVCrs.js").then(t=>t.h),__vite__mapDeps([4,1])),b(()=>import("./mediapipe-CLPwVCrs.js").then(t=>t.c),__vite__mapDeps([4,1]))]);p=c,y=a,N(!1)}catch(c){console.error("Failed to load MediaPipe:",c),o("Failed to load hand tracking. Please refresh the page."),N(!1)}})()},[]),n.useEffect(()=>{if(!(!i.current||!s.current||!p||!y||m)&&d){try{const r=new p({locateFile:a=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${a}`});r.setOptions({maxNumHands:1,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),r.onResults(a=>{if(s.current&&i.current){const t=s.current.getContext("2d");if(!t)return;if(t.save(),t.clearRect(0,0,s.current.width,s.current.height),t.drawImage(a.image,0,0,s.current.width,s.current.height),a.multiHandLandmarks&&a.multiHandLandmarks.length>0){const l=a.multiHandLandmarks[0];t.strokeStyle="#FFA000",t.lineWidth=2,t.fillStyle="#B8860B",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[17,18],[18,19],[19,20],[0,17]].forEach(([g,D])=>{const E=l[g],M=l[D];t.beginPath(),t.moveTo(E.x*s.current.width,E.y*s.current.height),t.lineTo(M.x*s.current.width,M.y*s.current.height),t.stroke()}),l.forEach(g=>{t.beginPath(),t.arc(g.x*s.current.width,g.y*s.current.height,4,0,2*Math.PI),t.fill()}),A(l)}t.restore()}}),u.current=r;const c=new y(i.current,{onFrame:async()=>{if(i.current&&u.current)try{await u.current.send({image:i.current})}catch(a){console.error("Error sending frame:",a)}},width:640,height:480});P.current=c,navigator.mediaDevices.getUserMedia({video:!0}).then(a=>{i.current&&(i.current.srcObject=a,c.start())}).catch(a=>{console.error("Camera access denied:",a),o("Camera access is required. Please allow camera permissions."),v(!1)})}catch(r){console.error("Error initializing hand tracking:",r),o("Failed to initialize hand tracking."),v(!1)}return()=>{if(P.current)try{P.current.stop()}catch(r){console.error("Error stopping camera:",r)}if(i.current&&i.current.srcObject&&(i.current.srcObject.getTracks().forEach(c=>c.stop()),i.current.srcObject=null),u.current)try{u.current.close()}catch(r){console.error("Error closing hands:",r)}}}},[d,m]);const A=r=>{const c=r[4].y<r[3].y,a=r[8].y<r[6].y,t=r[12].y<r[10].y,l=r[16].y<r[14].y,f=r[20].y<r[18].y;c&&!a&&!t&&!l&&!f?(x("Abhaya Mudra"),h(85)):!c&&a&&t&&!l&&!f?(x("Chin Mudra"),h(90)):c&&a&&t&&l&&f?(x("Anjali Mudra"),h(95)):(x(null),h(0))},C=async()=>{if(!p||!y){o("Hand tracking is still loading. Please wait...");return}if(!d&&(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)){o("Camera is not available on this device.");return}v(!d),o(null)};return e.jsx("div",{className:"relative min-h-screen pt-20 md:pt-24 bg-gradient-to-b from-white to-gray-50",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-8 md:py-12",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[e.jsx("h1",{className:"text-4xl sm:text-5xl md:text-6xl lg:text-8xl font-display font-bold mb-4 md:mb-6 text-gradient px-4",children:"Practice Mudras"}),e.jsx("p",{className:"text-base sm:text-lg md:text-xl text-gray-600 max-w-2xl mx-auto px-4",children:"Use your webcam to practice mudras in real-time with AI-powered feedback"})]}),_&&e.jsx("div",{className:"max-w-2xl mx-auto mb-6 glass-strong rounded-2xl p-4 text-center",children:e.jsx("p",{className:"text-red-600",children:_})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 md:gap-8 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"glass-strong rounded-2xl md:rounded-3xl p-4 sm:p-6 md:p-8",children:[e.jsxs("div",{className:"relative aspect-video bg-dark-400 rounded-xl md:rounded-2xl overflow-hidden mb-4 md:mb-6",children:[e.jsx("video",{ref:i,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0,style:{transform:"scaleX(-1)"}}),e.jsx("canvas",{ref:s,className:"absolute inset-0",width:640,height:480,style:{transform:"scaleX(-1)"}}),m&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-saffron-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Loading hand tracking..."})]})})]}),e.jsx("button",{onClick:C,disabled:m,className:`w-full py-3 md:py-4 rounded-full font-medium text-base md:text-lg transition-all shadow-sm ${m?"bg-gray-300 cursor-not-allowed opacity-50 text-gray-600":d?"bg-red-600 hover:bg-red-700 text-white":"bg-saffron-500 hover:bg-saffron-600 text-white"}`,children:m?"Loading...":d?"Stop Practice":"Start Practice"})]}),e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"glass-strong rounded-2xl md:rounded-3xl p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-display font-bold mb-4 text-saffron-600",children:"Detected Mudra"}),e.jsx(L,{mode:"wait",children:j?e.jsx(R.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"text-2xl sm:text-3xl md:text-4xl font-bold text-gold-600 mb-2",children:j},j):e.jsx("div",{className:"text-lg sm:text-xl md:text-2xl text-gray-500",children:"No mudra detected"})}),w>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2 text-gray-700",children:[e.jsx("span",{children:"Accuracy"}),e.jsxs("span",{children:[w,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx(R.div,{initial:{width:0},animate:{width:`${w}%`},className:"bg-gradient-to-r from-saffron-500 to-gold-500 h-2 rounded-full"})})]})]}),e.jsxs("div",{className:"glass rounded-2xl md:rounded-3xl p-6 md:p-8 hidden md:block",children:[e.jsx("h3",{className:"text-lg md:text-xl font-display font-bold mb-4 text-gray-900",children:"3D Preview"}),e.jsx("div",{className:"aspect-square rounded-xl md:rounded-2xl overflow-hidden bg-gray-100",children:e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-saffron-400 border-t-transparent rounded-full animate-spin"})}),children:e.jsx(S,{enableEffects:!0,enableParticles:!1,enableHand:!0,children:e.jsx(H,{})})})})]})]})]})]})})}export{T as default};
